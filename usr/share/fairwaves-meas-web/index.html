<html>
  <head>
    <script src="./js/jquery-3.3.1.min.js"></script>
    <script src="./js/d3.min.js"></script>
    <script src="./js/meas_web.js"></script>
    <link rel="stylesheet" type="text/css" href="meas_web.css">  
  </head>
  <body>
      <div>
        maximum items:
        <select name="maxitems" id="maxitems" onchange="paramMaxItems(this.value)">
          <option value="10" selected >10</option>
          <option value="20">20</option>
          <option value="50">50</option>
        </select>
      </div>
    <div class="meas table">
      <div class="table-title">
        <h3>Signal strength measurements</h3>
        <div id="last_time"></div>
      </div>
      <div class="table-heading">
        <div class="cell"><p>Name</p></div>
        <div class="cell sortby" onClick="paramSortBy('imsi');"><p><small id="imsi" class="sortby-inactive">▼</small>IMSI</p></div>
        <div class="cell"><p>Type</p></div>
        <div class="cell"><p>Channel</p></div>
        <div class="cell"><p>Duration</p></div>
        <div class="cell sortby" onClick="paramSortBy('age');"><p><small id="age" class="
        sortby-active">▼</small>Age</p></div>
        <div class="cell"><p>NR</p></div>
        <div class="cell"><p> </p></div>
        <div class="cell"><p>Q</p></div>
        <div class="cell"><p>Signal strength</p></div>
        <div class="cell"><p>PWR</p></div>
        <div class="cell"><p>TA</p></div>
        <div class="cell"><p>Neigh.</p></div>
	
     </div>
    </div>

<script language="javascript">
  <!--
  var MAXW = 300;
  var MAXPWR = -45;
  var MINPWR = -120;

  var DATA_MAX_IMSI = 10; // # of items
  var SORT_ITEMS_BY = 'age'; // or 'imsi'

  var MEAS_TIMEOUT = 4; // seconds

  var xScale = d3.scaleLinear()
    .domain([MINPWR, MAXPWR])
    .range([0, MAXW]);

  var data = [];
  var selected_imsi = 0;
  var max_neigh = 0

document.addEventListener("DOMContentLoaded", function(event) {
  var loc = window.location;
  var ws = new WebSocket('ws://' + loc.host + '/');
  ws.onmessage = function(event) {
    var evt_data = event.data;
    if (evt_data) {
      update_data(JSON.parse(evt_data));
      // data is now updated
      // Sort the data, active first, 
      sort_data();
      trim_data();
      update_reports();
    }
  };

setInterval(function() {
    refresh_data() && update_reports();
  }, 1000);
});      

 // -->
    </script>
  </body>
</html>
